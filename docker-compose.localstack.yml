name: my-mern-tiny-app-localstack

services:
  # LocalStack - AWS Services Emulator
  # Used by Terraform to provision EC2 instances
  # All other services (MongoDB, Kafka, Zookeeper, App, Consumer, UI) 
  # are deployed on EC2 instances via Terraform
  localstack:
    image: localstack/localstack:latest
    container_name: localstack
    restart: unless-stopped
    ports:
      - "4567:4566"  # LocalStack Edge port (changed to 4567 to avoid conflict)
      - "4510-4559:4510-4559"  # External services port range
    environment:
      - SERVICES=ec2,s3,iam,sts,ssm,cloudformation
      - DEBUG=1
      # Enable Pro features if you have LocalStack Pro
      # - LOCALSTACK_API_KEY=${LOCALSTACK_API_KEY:-}
    # LocalStack data persistence (uncomment to persist data across restarts)
    # volumes:
    #   - "./localstack-data:/var/lib/localstack"
    networks:
      - localstack-network

networks:
  localstack-network:
    driver: bridge

